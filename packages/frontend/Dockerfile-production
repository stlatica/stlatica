FROM node:18.17.0-slim
WORKDIR /app

RUN npm install -g pnpm@8
RUN echo 'alias pn="pnpm"' >> ~/.bashrc && echo 'alias px="pnpx"' >> ~/.bashrc

COPY . .

RUN rm -Rf node_modules && pnpm install --frozen-lockfile
RUN rm -Rf .next && pnpm build

CMD ["pnpm", "start", "--port", "3010"]