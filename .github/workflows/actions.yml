name: frontend_build
run-name: ${{ github.actor }} is learning GitHub Actions

on: [push]
jobs:
  build_frontend:
    if: ${{ always() }}    # 無条件にjobを実行
    runs-on: ubuntu-20.04
    defaults:
      run:
        working-directory: packages/frontend
    steps: 
      # [1] リポジトリをチェックアウト
      - uses: actions/checkout@v3
      
      # [2] pnpm 8をインストール
      - uses: pnpm/action-setup@v2
        with: 
          version: 8

      # [3] node.jsをインストール()
      - name: Node.js 
        uses: actions/setup-node@v3
        with:
          cache: 'pnpm'
          cache-dependency-path: packages/frontend/

      # [4] 依存関係先をインストール
      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      # [5] ビルドチェック(linterが在れば要らない？)
      - name: build check
        run: pnpm build

      # [6] 単体テスト
      - name: unit test
        run: pnpm ci/test

      # [7] コンポーネントカタログをビルド
      - name: catalog build
        run: pnpm ci/ladle
