name: build
run-name: build was executed by ${{ github.actor }}

on: [push]
jobs:
  build_frontend:
    if: ${{ always() }}    # 無条件にjobを実行
    runs-on: ubuntu-20.04
    defaults:
      run:
        working-directory: packages/frontend
    steps: 
      # リポジトリをチェックアウト
      - uses: actions/checkout@v3
      
      # pnpm 8をインストール
      - uses: pnpm/action-setup@v2
        with: 
          version: 8

      # node.jsをインストール()
      - name: Node.js 
        uses: actions/setup-node@v3
        with:
          cache: 'pnpm'
          cache-dependency-path: packages/frontend/

      # 依存関係先をインストール
      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      # lint
      - name: static code analysis
        run: pnpm ci/lint

      # ビルドチェック(linterが在れば要らない？)
      - name: build check
        run: pnpm build

      #  単体テスト
      - name: unit test
        run: pnpm ci/test

      #  コンポーネントカタログをビルド
      - name: catalog build
        run: pnpm ci/ladle
